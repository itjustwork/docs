# üîí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - –í–æ–ø—Ä–æ—Å—ã –∏ –û—Ç–≤–µ—Ç—ã

## –û—Å–Ω–æ–≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**Q: –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—á–µ–º –æ–Ω–æ –Ω—É–∂–Ω–æ?**
A: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã—è–≤–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º–∏ –¥–ª—è –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞–º.

**–¶–µ–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- ‚úÖ –í—ã—è–≤–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∞—Ç–∞–∫ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

**Q: –ö–∞–∫–∏–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç?**
A:

| –¢–∏–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|------------------|----------|---------|
| **–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (SAST)** | –ê–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | SonarQube, Checkmarx, Fortify |
| **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (DAST)** | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | OWASP ZAP, Burp Suite, Acunetix |
| **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (IAST)** | –ê–Ω–∞–ª–∏–∑ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | Contrast Security, Hdiv |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ** | –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ç–∞–∫ | Metasploit, Nmap, Kali Linux |
| **–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä | –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –∏–Ω—Ç–µ—Ä–≤—å—é |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | CIS Benchmarks, NIST |

## OWASP Top 10

**Q: –ß—Ç–æ —Ç–∞–∫–æ–µ OWASP Top 10 –∏ –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏?**
A: OWASP Top 10 - —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –Ω–∞–∏–±–æ–ª–µ–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π Open Web Application Security Project.

### 1. Broken Access Control (A01:2021)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞.

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```python
import requests
import pytest

class TestAccessControl:
    base_url = "https://api.example.com"
    
    def test_horizontal_privilege_escalation(self):
        """–¢–µ—Å—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π"""
        # –õ–æ–≥–∏–Ω –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1
        user1_token = self.login("user1@example.com", "password123")
        
        # –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 2
        response = requests.get(
            f"{self.base_url}/users/2/profile",
            headers={'Authorization': f'Bearer {user1_token}'}
        )
        
        # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 403 Forbidden
        assert response.status_code == 403
    
    def test_vertical_privilege_escalation(self):
        """–¢–µ—Å—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π"""
        # –õ–æ–≥–∏–Ω –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        user_token = self.login("user@example.com", "password123")
        
        # –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º
        response = requests.post(
            f"{self.base_url}/admin/users",
            headers={'Authorization': f'Bearer {user_token}'},
            json={"action": "delete", "user_id": 1}
        )
        
        # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 403 Forbidden
        assert response.status_code == 403
    
    def test_missing_authentication(self):
        """–¢–µ—Å—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"""
        # –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
        response = requests.get(f"{self.base_url}/admin/users")
        
        # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 401 Unauthorized
        assert response.status_code == 401
    
    def login(self, email, password):
        """–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞"""
        response = requests.post(
            f"{self.base_url}/auth/login",
            json={"email": email, "password": password}
        )
        return response.json()['token']
```

### 2. Cryptographic Failures (A02:2021)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏.

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```python
import requests
import ssl
import socket
from cryptography import x509
from cryptography.hazmat.backends import default_backend

class TestCryptographicFailures:
    
    def test_weak_ssl_tls(self):
        """–¢–µ—Å—Ç —Å–ª–∞–±—ã—Ö SSL/TLS –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
        hostname = "example.com"
        port = 443
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
        context = ssl.create_default_context()
        with socket.create_connection((hostname, port)) as sock:
            with context.wrap_socket(sock, server_hostname=hostname) as ssock:
                version = ssock.version()
                cipher = ssock.cipher()
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ TLS
                assert "TLSv1.2" in version or "TLSv1.3" in version
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤
                weak_ciphers = ['RC4', 'DES', '3DES', 'MD5']
                for weak_cipher in weak_ciphers:
                    assert weak_cipher not in cipher[0]
    
    def test_weak_password_hashing(self):
        """–¢–µ—Å—Ç —Å–ª–∞–±–æ–≥–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–∞—Ä–æ–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
        response = requests.post(
            "https://api.example.com/auth/login",
            json={"email": "user@example.com", "password": "password123"}
        )
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤ –æ—Ç–≤–µ—Ç–µ –Ω–µ—Ç —Ö–µ—à–∞ –ø–∞—Ä–æ–ª—è
        response_data = response.json()
        assert 'password' not in response_data
        assert 'password_hash' not in response_data
    
    def test_sensitive_data_exposure(self):
        """–¢–µ—Å—Ç —É—Ç–µ—á–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö
        response = requests.get(
            "https://api.example.com/users/1",
            headers={'Authorization': 'Bearer valid_token'}
        )
        
        user_data = response.json()
        sensitive_fields = ['password', 'ssn', 'credit_card', 'api_key']
        
        for field in sensitive_fields:
            assert field not in user_data
```

### 3. Injection (A03:2021)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SQL Injection:**
```python
import requests
import time

class TestSQLInjection:
    base_url = "https://api.example.com"
    
    def test_sql_injection_login(self):
        """–¢–µ—Å—Ç SQL injection –≤ —Ñ–æ—Ä–º–µ –ª–æ–≥–∏–Ω–∞"""
        payloads = [
            "' OR '1'='1",
            "' OR 1=1--",
            "admin'--",
            "' UNION SELECT 1,2,3--",
            "'; DROP TABLE users--"
        ]
        
        for payload in payloads:
            response = requests.post(
                f"{self.base_url}/auth/login",
                json={"email": payload, "password": "password123"}
            )
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –≤–æ–π—Ç–∏ —Å SQL injection
            assert response.status_code != 200 or "token" not in response.json()
    
    def test_sql_injection_search(self):
        """–¢–µ—Å—Ç SQL injection –≤ –ø–æ–∏—Å–∫–µ"""
        payloads = [
            "' OR '1'='1",
            "'; SELECT * FROM users--",
            "' UNION SELECT username,password FROM users--"
        ]
        
        for payload in payloads:
            response = requests.get(
                f"{self.base_url}/users/search",
                params={"q": payload}
            )
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            assert response.status_code != 200 or len(response.json()) == 0
    
    def test_blind_sql_injection(self):
        """–¢–µ—Å—Ç —Å–ª–µ–ø–æ–π SQL injection"""
        # –¢–µ—Å—Ç —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
        start_time = time.time()
        response = requests.get(
            f"{self.base_url}/users/1",
            params={"id": "1' AND (SELECT SLEEP(5))--"}
        )
        end_time = time.time()
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å, –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∑–∞–Ω—è—Ç—å 5+ —Å–µ–∫—É–Ω–¥
        if end_time - start_time > 5:
            print("WARNING: Possible blind SQL injection detected!")
```

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è XSS:**
```python
class TestXSS:
    
    def test_reflected_xss(self):
        """–¢–µ—Å—Ç –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ XSS"""
        payloads = [
            "<script>alert('XSS')</script>",
            "javascript:alert('XSS')",
            "<img src=x onerror=alert('XSS')>",
            "<svg onload=alert('XSS')>",
            "';alert('XSS');//"
        ]
        
        for payload in payloads:
            response = requests.get(
                "https://api.example.com/search",
                params={"q": payload}
            )
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ payload –Ω–µ –æ—Ç—Ä–∞–∂–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ
            assert payload not in response.text
    
    def test_stored_xss(self):
        """–¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ XSS"""
        payload = "<script>alert('XSS')</script>"
        
        # –û—Ç–ø—Ä–∞–≤–∫–∞ payload
        response = requests.post(
            "https://api.example.com/comments",
            json={"content": payload},
            headers={'Authorization': 'Bearer valid_token'}
        )
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
        comment_id = response.json()['id']
        get_response = requests.get(f"https://api.example.com/comments/{comment_id}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ payload –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω
        assert payload not in get_response.text
```

### 4. Insecure Design (A04:2021)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¥–∏–∑–∞–π–Ω.

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```python
class TestInsecureDesign:
    
    def test_predictable_resource_ids(self):
        """–¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö ID —Ä–µ—Å—É—Ä—Å–æ–≤"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ ID –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏
        ids = []
        for i in range(10):
            response = requests.get(f"https://api.example.com/users/{i+1}")
            if response.status_code == 200:
                user_id = response.json()['id']
                ids.append(user_id)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ ID –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º–∏ —á–∏—Å–ª–∞–º–∏
        for user_id in ids:
            assert user_id > 1000  # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–º–∏
    
    def test_mass_assignment(self):
        """–¢–µ—Å—Ç –º–∞—Å—Å–æ–≤–æ–≥–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è"""
        # –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–µ –ø–æ–ª—è
        user_data = {
            "name": "Test User",
            "email": "test@example.com",
            "role": "admin",  # –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
            "is_active": True,
            "permissions": ["read", "write", "delete"]
        }
        
        response = requests.post(
            "https://api.example.com/users",
            json=user_data
        )
        
        if response.status_code == 201:
            created_user = response.json()
            # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –Ω–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
            assert created_user.get('role') != 'admin'
            assert 'permissions' not in created_user
```

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**Q: –ö–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏?**
A:

### OWASP ZAP
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
from zapv2 import ZAPv2
import time

class ZAPSecurityTest:
    
    def __init__(self):
        self.zap = ZAPv2(proxies={'http': 'http://localhost:8080', 'https': 'http://localhost:8080'})
    
    def run_security_scan(self, target_url):
        """–ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        print(f"–ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ {target_url}")
        
        # –ü–∞—Å—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        print("–ó–∞–ø—É—Å–∫ –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è...")
        self.zap.urlopen(target_url)
        time.sleep(2)
        
        # –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        print("–ó–∞–ø—É—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è...")
        scan_id = self.zap.ascan.scan(target_url)
        
        # –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        while int(self.zap.ascan.status(scan_id)) < 100:
            print(f"–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {self.zap.ascan.status(scan_id)}%")
            time.sleep(5)
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        alerts = self.zap.core.alerts()
        
        # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        high_alerts = [alert for alert in alerts if alert['risk'] == 'High']
        medium_alerts = [alert for alert in alerts if alert['risk'] == 'Medium']
        
        print(f"–ù–∞–π–¥–µ–Ω–æ –≤—ã—Å–æ–∫–∏—Ö —Ä–∏—Å–∫–æ–≤: {len(high_alerts)}")
        print(f"–ù–∞–π–¥–µ–Ω–æ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–∏—Å–∫–æ–≤: {len(medium_alerts)}")
        
        return {
            'high_alerts': high_alerts,
            'medium_alerts': medium_alerts,
            'all_alerts': alerts
        }
    
    def test_specific_vulnerability(self, target_url, vulnerability_type):
        """–¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —É—è–∑–≤–∏–º–æ—Å—Ç–∏"""
        if vulnerability_type == 'sql_injection':
            # –¢–µ—Å—Ç SQL injection
            test_urls = [
                f"{target_url}/search?q=test'",
                f"{target_url}/user?id=1'",
                f"{target_url}/product?id=1' OR '1'='1"
            ]
            
            for url in test_urls:
                self.zap.urlopen(url)
                time.sleep(1)
        
        elif vulnerability_type == 'xss':
            # –¢–µ—Å—Ç XSS
            payloads = [
                "<script>alert('XSS')</script>",
                "javascript:alert('XSS')",
                "<img src=x onerror=alert('XSS')>"
            ]
            
            for payload in payloads:
                test_url = f"{target_url}/search?q={payload}"
                self.zap.urlopen(test_url)
                time.sleep(1)
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        alerts = self.zap.core.alerts()
        return [alert for alert in alerts if vulnerability_type.lower() in alert['name'].lower()]

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
zap_test = ZAPSecurityTest()
results = zap_test.run_security_scan("https://example.com")
```

### Burp Suite
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

**–ü—Ä–∏–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:**
```python
import requests
from burp import IBurpExtender
from burp import IScannerCheck
from burp import IScanIssue

class CustomSecurityScanner(IBurpExtender, IScannerCheck):
    
    def registerExtenderCallbacks(self, callbacks):
        self._callbacks = callbacks
        self._helpers = callbacks.getHelpers()
        callbacks.setExtensionName("Custom Security Scanner")
        callbacks.registerScannerCheck(self)
    
    def doPassiveScan(self, baseRequestResponse):
        """–ü–∞—Å—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"""
        issues = []
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        response = baseRequestResponse.getResponse()
        response_info = self._helpers.analyzeResponse(response)
        headers = response_info.getHeaders()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        security_headers = [
            'X-Content-Type-Options',
            'X-Frame-Options',
            'X-XSS-Protection',
            'Strict-Transport-Security'
        ]
        
        for header in security_headers:
            if not any(header in h for h in headers):
                issues.append(self.create_issue(
                    baseRequestResponse,
                    f"Missing Security Header: {header}",
                    "The application is missing important security headers."
                ))
        
        return issues
    
    def doActiveScan(self, baseRequestResponse, insertionPoint):
        """–ê–∫—Ç–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"""
        issues = []
        
        # –¢–µ—Å—Ç SQL injection
        sql_payloads = [
            "' OR '1'='1",
            "'; DROP TABLE users--",
            "' UNION SELECT 1,2,3--"
        ]
        
        for payload in sql_payloads:
            # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å payload
            checkRequest = insertionPoint.buildRequest(payload)
            checkRequestResponse = self._callbacks.makeHttpRequest(
                baseRequestResponse.getHttpService(), checkRequest
            )
            
            # –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ SQL injection
            if self.detect_sql_injection(checkRequestResponse):
                issues.append(self.create_issue(
                    checkRequestResponse,
                    "SQL Injection Vulnerability",
                    f"SQL injection detected with payload: {payload}"
                ))
        
        return issues
    
    def detect_sql_injection(self, response):
        """–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL injection –ø–æ –æ—Ç–≤–µ—Ç—É"""
        response_data = response.getResponse()
        response_string = self._helpers.bytesToString(response_data)
        
        # –ü—Ä–∏–∑–Ω–∞–∫–∏ SQL injection
        sql_errors = [
            "sql syntax",
            "mysql_fetch_array",
            "ora-",
            "sql server",
            "postgresql",
            "sqlite"
        ]
        
        return any(error.lower() in response_string.lower() for error in sql_errors)
    
    def create_issue(self, requestResponse, name, description):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏"""
        return CustomScanIssue(
            requestResponse.getHttpService(),
            self._helpers.analyzeRequest(requestResponse).getUrl(),
            [requestResponse],
            name,
            description,
            "High",
            "Certain"
        )

class CustomScanIssue(IScanIssue):
    def __init__(self, httpService, url, httpMessages, name, description, severity, confidence):
        self._httpService = httpService
        self._url = url
        self._httpMessages = httpMessages
        self._name = name
        self._description = description
        self._severity = severity
        self._confidence = confidence
    
    def getUrl(self):
        return self._url
    
    def getIssueName(self):
        return self._name
    
    def getIssueType(self):
        return 0
    
    def getSeverity(self):
        return self._severity
    
    def getConfidence(self):
        return self._confidence
    
    def getIssueBackground(self):
        return self._description
    
    def getRemediationBackground(self):
        return "Implement proper input validation and use parameterized queries."
    
    def getIssueDetail(self):
        return self._description
    
    def getRemediationDetail(self):
        return "Use prepared statements and input validation."
    
    def getHttpMessages(self):
        return self._httpMessages
    
    def getHttpService(self):
        return self._httpService
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**Q: –ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏?**
A:

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD
```yaml
# .github/workflows/security-test.yml
name: Security Testing

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  security-scan:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Setup Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'
    
    - name: Install dependencies
      run: |
        pip install bandit safety
        npm install -g audit
    
    - name: Run Bandit (Python security scanner)
      run: |
        bandit -r . -f json -o bandit-report.json
        bandit -r . -f txt -o bandit-report.txt
    
    - name: Run Safety (Python dependency scanner)
      run: |
        safety check --json --output safety-report.json
        safety check --output safety-report.txt
    
    - name: Run npm audit
      run: |
        npm audit --audit-level=moderate --json > npm-audit-report.json
        npm audit --audit-level=moderate > npm-audit-report.txt
    
    - name: Upload security reports
      uses: actions/upload-artifact@v2
      with:
        name: security-reports
        path: |
          bandit-report.json
          bandit-report.txt
          safety-report.json
          safety-report.txt
          npm-audit-report.json
          npm-audit-report.txt
    
    - name: Comment PR with security findings
      if: github.event_name == 'pull_request'
      uses: actions/github-script@v6
      with:
        script: |
          const fs = require('fs');
          
          let comment = '## üîí Security Scan Results\n\n';
          
          // Read Bandit results
          if (fs.existsSync('bandit-report.txt')) {
            const banditResults = fs.readFileSync('bandit-report.txt', 'utf8');
            comment += '### Python Security Issues (Bandit)\n';
            comment += '```\n' + banditResults + '\n```\n\n';
          }
          
          // Read Safety results
          if (fs.existsSync('safety-report.txt')) {
            const safetyResults = fs.readFileSync('safety-report.txt', 'utf8');
            comment += '### Python Dependencies (Safety)\n';
            comment += '```\n' + safetyResults + '\n```\n\n';
          }
          
          // Read npm audit results
          if (fs.existsSync('npm-audit-report.txt')) {
            const npmResults = fs.readFileSync('npm-audit-report.txt', 'utf8');
            comment += '### Node.js Dependencies (npm audit)\n';
            comment += '```\n' + npmResults + '\n```\n\n';
          }
          
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: comment
          });
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
import pytest
import requests
import subprocess
import json
from typing import List, Dict

class SecurityTestSuite:
    
    def __init__(self, base_url: str):
        self.base_url = base_url
        self.session = requests.Session()
    
    def test_authentication_bypass(self):
        """–¢–µ—Å—Ç –æ–±—Ö–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"""
        # –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        protected_endpoints = [
            "/admin/users",
            "/api/sensitive-data",
            "/user/profile",
            "/admin/settings"
        ]
        
        for endpoint in protected_endpoints:
            response = self.session.get(f"{self.base_url}{endpoint}")
            assert response.status_code in [401, 403], f"Endpoint {endpoint} accessible without authentication"
    
    def test_sql_injection_scan(self):
        """–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ SQL injection"""
        payloads = [
            "' OR '1'='1",
            "'; DROP TABLE users--",
            "' UNION SELECT 1,2,3--",
            "admin'--",
            "1' AND (SELECT COUNT(*) FROM users) > 0--"
        ]
        
        vulnerable_endpoints = []
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ endpoints
        test_endpoints = [
            "/search?q={payload}",
            "/user?id={payload}",
            "/product?id={payload}",
            "/api/users?filter={payload}"
        ]
        
        for endpoint_template in test_endpoints:
            for payload in payloads:
                endpoint = endpoint_template.format(payload=payload)
                response = self.session.get(f"{self.base_url}{endpoint}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ SQL injection
                if self.detect_sql_injection_response(response):
                    vulnerable_endpoints.append(endpoint)
        
        assert len(vulnerable_endpoints) == 0, f"SQL injection vulnerabilities found: {vulnerable_endpoints}"
    
    def test_xss_scan(self):
        """–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ XSS"""
        payloads = [
            "<script>alert('XSS')</script>",
            "javascript:alert('XSS')",
            "<img src=x onerror=alert('XSS')>",
            "<svg onload=alert('XSS')>",
            "';alert('XSS');//"
        ]
        
        vulnerable_endpoints = []
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ–æ—Ä–º—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        test_data = [
            {"endpoint": "/search", "param": "q"},
            {"endpoint": "/comment", "param": "content"},
            {"endpoint": "/user/profile", "param": "name"}
        ]
        
        for test in test_data:
            for payload in payloads:
                data = {test["param"]: payload}
                response = self.session.post(f"{self.base_url}{test['endpoint']}", data=data)
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ payload –Ω–µ –æ—Ç—Ä–∞–∂–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ
                if payload in response.text:
                    vulnerable_endpoints.append(f"{test['endpoint']} ({test['param']})")
        
        assert len(vulnerable_endpoints) == 0, f"XSS vulnerabilities found: {vulnerable_endpoints}"
    
    def test_csrf_protection(self):
        """–¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç CSRF"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ CSRF —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ö
        response = self.session.get(f"{self.base_url}/login")
        
        # –ò—â–µ–º CSRF —Ç–æ–∫–µ–Ω—ã
        csrf_tokens = [
            'csrf_token',
            '_token',
            'authenticity_token',
            'csrf'
        ]
        
        has_csrf_protection = any(token in response.text for token in csrf_tokens)
        assert has_csrf_protection, "No CSRF protection detected"
    
    def test_security_headers(self):
        """–¢–µ—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        response = self.session.get(self.base_url)
        headers = response.headers
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–∞–∂–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        security_headers = {
            'X-Content-Type-Options': 'nosniff',
            'X-Frame-Options': ['DENY', 'SAMEORIGIN'],
            'X-XSS-Protection': '1; mode=block',
            'Strict-Transport-Security': None,  # –õ—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            'Content-Security-Policy': None     # –õ—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        }
        
        missing_headers = []
        for header, expected_value in security_headers.items():
            if header not in headers:
                missing_headers.append(header)
            elif expected_value and headers[header] not in expected_value:
                missing_headers.append(f"{header} (incorrect value)")
        
        assert len(missing_headers) == 0, f"Missing security headers: {missing_headers}"
    
    def test_sensitive_data_exposure(self):
        """–¢–µ—Å—Ç —É—Ç–µ—á–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è
        response = self.session.get(f"{self.base_url}/api/users/1")
        
        if response.status_code == 200:
            user_data = response.json()
            sensitive_fields = ['password', 'ssn', 'credit_card', 'api_key', 'secret']
            
            exposed_fields = [field for field in sensitive_fields if field in user_data]
            assert len(exposed_fields) == 0, f"Sensitive data exposed: {exposed_fields}"
    
    def detect_sql_injection_response(self, response) -> bool:
        """–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL injection –ø–æ –æ—Ç–≤–µ—Ç—É"""
        sql_errors = [
            'sql syntax',
            'mysql_fetch_array',
            'ora-',
            'sql server',
            'postgresql',
            'sqlite',
            'mysql_num_rows',
            'mysql_fetch_assoc'
        ]
        
        response_text = response.text.lower()
        return any(error in response_text for error in sql_errors)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ pytest
@pytest.fixture
def security_tester():
    return SecurityTestSuite("https://example.com")

def test_security_suite(security_tester):
    """–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
    security_tester.test_authentication_bypass()
    security_tester.test_sql_injection_scan()
    security_tester.test_xss_scan()
    security_tester.test_csrf_protection()
    security_tester.test_security_headers()
    security_tester.test_sensitive_data_exposure()
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

**Q: –ö–∞–∫–∏–µ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏?**
A:

### 1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
class SecurityTestPlan:
    def __init__(self):
        self.test_categories = []
        self.risk_levels = ['Low', 'Medium', 'High', 'Critical']
    
    def add_test_category(self, category, description, risk_level):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤"""
        self.test_categories.append({
            'category': category,
            'description': description,
            'risk_level': risk_level,
            'tests': []
        })
    
    def add_test(self, category, test_name, test_function, expected_result):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é"""
        for cat in self.test_categories:
            if cat['category'] == category:
                cat['tests'].append({
                    'name': test_name,
                    'function': test_function,
                    'expected': expected_result
                })
                break
    
    def generate_report(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏"""
        report = {
            'summary': {
                'total_tests': 0,
                'passed': 0,
                'failed': 0,
                'critical_issues': 0
            },
            'categories': []
        }
        
        for category in self.test_categories:
            cat_report = {
                'name': category['category'],
                'risk_level': category['risk_level'],
                'tests': []
            }
            
            for test in category['tests']:
                try:
                    result = test['function']()
                    passed = result == test['expected']
                    
                    cat_report['tests'].append({
                        'name': test['name'],
                        'passed': passed,
                        'result': result
                    })
                    
                    report['summary']['total_tests'] += 1
                    if passed:
                        report['summary']['passed'] += 1
                    else:
                        report['summary']['failed'] += 1
                        if category['risk_level'] == 'Critical':
                            report['summary']['critical_issues'] += 1
                            
                except Exception as e:
                    cat_report['tests'].append({
                        'name': test['name'],
                        'passed': False,
                        'error': str(e)
                    })
                    report['summary']['total_tests'] += 1
                    report['summary']['failed'] += 1
            
            report['categories'].append(cat_report)
        
        return report

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
plan = SecurityTestPlan()
plan.add_test_category('Authentication', 'Tests for authentication bypass', 'Critical')
plan.add_test_category('Input Validation', 'Tests for injection attacks', 'High')
plan.add_test_category('Data Protection', 'Tests for data exposure', 'Medium')

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
def test_auth_bypass():
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
    return True

plan.add_test('Authentication', 'Admin Access Bypass', test_auth_bypass, True)
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
import logging
import time
from datetime import datetime

class SecurityMonitor:
    def __init__(self):
        self.logger = logging.getLogger('security_monitor')
        self.suspicious_activities = []
    
    def monitor_request(self, request_data):
        """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
        suspicious_patterns = [
            'script',
            'javascript:',
            'union select',
            'drop table',
            'exec(',
            'eval(',
            '../',
            '..\\'
        ]
        
        request_string = str(request_data).lower()
        
        for pattern in suspicious_patterns:
            if pattern in request_string:
                self.log_suspicious_activity(request_data, pattern)
                return True
        
        return False
    
    def log_suspicious_activity(self, request_data, pattern):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        activity = {
            'timestamp': datetime.now(),
            'pattern': pattern,
            'request': request_data,
            'ip_address': request_data.get('ip', 'unknown'),
            'user_agent': request_data.get('user_agent', 'unknown')
        }
        
        self.suspicious_activities.append(activity)
        self.logger.warning(f"Suspicious activity detected: {pattern}")
    
    def generate_security_report(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        report = {
            'timestamp': datetime.now(),
            'total_suspicious_activities': len(self.suspicious_activities),
            'activities_by_pattern': {},
            'activities_by_ip': {}
        }
        
        for activity in self.suspicious_activities:
            pattern = activity['pattern']
            ip = activity['ip_address']
            
            if pattern not in report['activities_by_pattern']:
                report['activities_by_pattern'][pattern] = 0
            report['activities_by_pattern'][pattern] += 1
            
            if ip not in report['activities_by_ip']:
                report['activities_by_ip'][ip] = 0
            report['activities_by_ip'][ip] += 1
        
        return report
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

**Q: –ö–∞–∫–∏–µ –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏?**
A:

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ —Å nmap
nmap -sS -sV -O target.com
nmap --script vuln target.com
nmap -p 80,443,8080 target.com

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SSL/TLS
nmap --script ssl-enum-ciphers -p 443 target.com
openssl s_client -connect target.com:443 -servername target.com

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —Å Nikto
nikto -h target.com
nikto -h target.com -p 443 -ssl

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å OWASP ZAP
zap-cli quick-scan --self-contained https://target.com
zap-cli active-scan https://target.com
zap-cli report -o security-report.html

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Burp Suite (—á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É)
burp-rest-api --config-file=burp-config.json

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm audit
pip-audit
safety check
bundler audit

# –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
bandit -r /path/to/code
semgrep --config=auto /path/to/code
sonar-scanner

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker run --rm -v $(pwd):/app aquasec/trivy config /app
kubesec scan deployment.yaml

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
fail2ban-client status
logwatch --detail High
rkhunter --check

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt

# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞
tcpdump -i eth0 -w capture.pcap
wireshark capture.pcap
tshark -r capture.pcap -Y "http.request.method==POST"
```
